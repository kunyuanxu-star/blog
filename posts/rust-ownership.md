---
title: æ·±å…¥ç†è§£ Rust æ‰€æœ‰æƒæœºåˆ¶
date: 2024-05-12
category: Rust
tags: [Rust, Memory Safety, Programming]
readTime: 8 min
excerpt: Rust çš„æ‰€æœ‰æƒç³»ç»Ÿæ˜¯å…¶æœ€ç‹¬ç‰¹çš„åŠŸèƒ½ã€‚å®ƒè®© Rust æ— éœ€åƒåœ¾å›æ”¶å³å¯ä¿éšœå†…å­˜å®‰å…¨ã€‚æœ¬æ–‡å°†é€šè¿‡å®é™…ä»£ç ç¤ºä¾‹ï¼Œæ·±å…¥å‰–æ Moveã€Clone å’Œ Copy çš„åŒºåˆ«...
image: https://images.unsplash.com/photo-1555066931-4365d14bab8c?auto=format&fit=crop&q=80&w=1000
---

# æ·±å…¥ç†è§£ Rust æ‰€æœ‰æƒæœºåˆ¶

Rust çš„æ‰€æœ‰æƒç³»ç»Ÿæ˜¯å…¶æœ€ç‹¬ç‰¹çš„åŠŸèƒ½ã€‚å®ƒè®© Rust æ— éœ€åƒåœ¾å›æ”¶å³å¯ä¿éšœå†…å­˜å®‰å…¨ã€‚

## ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒï¼Ÿ

æ‰€æœ‰æƒæ˜¯ Rust æœ€ä¸ºä¸ä¼—ä¸åŒçš„ç‰¹æ€§ï¼Œå®ƒè®© Rust æ— éœ€åƒåœ¾å›æ”¶ï¼ˆgarbage collectorï¼‰å³å¯ä¿éšœå†…å­˜å®‰å…¨ã€‚

### æ‰€æœ‰æƒè§„åˆ™

1. Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºå…¶ **æ‰€æœ‰è€…**ï¼ˆownerï¼‰çš„å˜é‡ã€‚
2. å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
3. å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚

## ç¤ºä¾‹ä»£ç 

```rust
fn main() {
    let s1 = String::from("hello");
    let s2 = s1; // s1 çš„å€¼è¢«ç§»åŠ¨åˆ° s2
    
    // println!("{}", s1); // è¿™ä¼šæŠ¥é”™ï¼
    println!("{}", s2); // è¿™æ˜¯æ­£ç¡®çš„
}
```

## å€Ÿç”¨ä¸å¼•ç”¨

Rust ä½¿ç”¨å€Ÿç”¨ï¼ˆborrowingï¼‰æœºåˆ¶æ¥åœ¨ä¸è·å–æ‰€æœ‰æƒçš„æƒ…å†µä¸‹è®¿é—®æ•°æ®ã€‚

```rust
fn main() {
    let s1 = String::from("hello");
    let len = calculate_length(&s1);
    
    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &String) -> usize {
    s.len()
}
```

## å¯å˜å¼•ç”¨

å¯å˜å¼•ç”¨å…è®¸ä½ ä¿®æ”¹å€Ÿç”¨çš„å€¼ï¼š

```rust
fn main() {
    let mut s = String::from("hello");
    change(&mut s);
    println!("{}", s); // "hello, world"
}

fn change(some_string: &mut String) {
    some_string.push_str(", world");
}
```

### å¯å˜å¼•ç”¨çš„é™åˆ¶

**é‡è¦è§„åˆ™**ï¼šåœ¨ç‰¹å®šä½œç”¨åŸŸä¸­çš„ç‰¹å®šæ•°æ®åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ã€‚

```rust
let mut s = String::from("hello");

let r1 = &mut s;
let r2 = &mut s; // âŒ é”™è¯¯ï¼ä¸èƒ½åŒæ—¶æœ‰ä¸¤ä¸ªå¯å˜å¼•ç”¨

println!("{}, {}", r1, r2);
```

## Slice ç±»å‹

Slice å…è®¸ä½ å¼•ç”¨é›†åˆä¸­ä¸€æ®µè¿ç»­çš„å…ƒç´ åºåˆ—ï¼Œè€Œä¸ç”¨å¼•ç”¨æ•´ä¸ªé›†åˆã€‚

```rust
fn first_word(s: &String) -> &str {
    let bytes = s.as_bytes();

    for (i, &item) in bytes.iter().enumerate() {
        if item == b' ' {
            return &s[0..i];
        }
    }

    &s[..]
}

fn main() {
    let mut s = String::from("hello world");
    let word = first_word(&s);
    
    // s.clear(); // âŒ é”™è¯¯ï¼s å·²è¢«ä¸å¯å˜å€Ÿç”¨
    println!("the first word is: {}", word);
}
```

## æ€»ç»“

æ‰€æœ‰æƒç³»ç»Ÿæ˜¯ Rust çš„æ ¸å¿ƒæ¦‚å¿µï¼Œç†è§£å®ƒå¯¹äºç¼–å†™é«˜æ•ˆã€å®‰å…¨çš„ Rust ä»£ç è‡³å…³é‡è¦ã€‚ä¸»è¦è¦ç‚¹ï¼š

- âœ… æ¯ä¸ªå€¼éƒ½æœ‰å”¯ä¸€çš„æ‰€æœ‰è€…
- âœ… é€šè¿‡å€Ÿç”¨å¯ä»¥ä¸´æ—¶è®¿é—®æ•°æ®
- âœ… ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥æ‰€æœ‰æƒè§„åˆ™
- âœ… é›¶è¿è¡Œæ—¶å¼€é”€çš„å†…å­˜å®‰å…¨

æŒæ¡æ‰€æœ‰æƒåï¼Œä½ ä¼šå‘ç° Rust çš„ç¼–è¯‘å™¨æ˜¯ä½ æœ€å¥½çš„æœ‹å‹ï¼ğŸ¦€
